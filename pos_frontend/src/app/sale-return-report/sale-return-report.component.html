<div class="max-w-6xl mx-auto mt-10 p-6 bg-white rounded-lg shadow-lg">
  <h2 class="text-2xl font-bold mb-6 text-gray-800 border-b pb-2">
     Sale Return Report
  </h2>

  <div *ngIf="loading" class="text-center py-6 text-gray-500">
    Loading report...
  </div>

  <div
    *ngIf="!loading && saleReturns.length === 0"
    class="text-center py-6 text-gray-500 italic"
  >
    No sale returns found.
  </div>

  <div *ngIf="!loading && saleReturns.length > 0" class="overflow-x-auto">
    <table
      class="min-w-full border border-gray-300 rounded-lg text-sm text-gray-700"
    >
      <thead class="bg-gray-100 text-left font-semibold">
        <tr>
          <th class="py-2 px-3 border text-center w-10">#</th>
          <th class="py-2 px-3 border">Return Date</th>
          <th class="py-2 px-3 border">Sale ID</th>
          <th class="py-2 px-3 border">Location</th>
          <th class="py-2 px-3 border">Reason</th>
          <th class="py-2 px-3 border text-right">Refund Amount (Rs.)</th>
        </tr>
      </thead>

      <tbody>
        <ng-container *ngFor="let returnData of saleReturns; let i = index">
          <tr class="hover:bg-gray-50 transition">
            <td class="py-2 px-3 border text-center font-medium">
              {{ i + 1 }}
            </td>
            <td class="py-2 px-3 border">
              {{ returnData.return_date | date: 'mediumDate' }}
            </td>
            <td class="py-2 px-3 border">{{ returnData.sale_id }}</td>
            <td class="py-2 px-3 border">
              {{ returnData.returnLocation?.name || 'â€”' }}
            </td>
            <td class="py-2 px-3 border">{{ returnData.reason }}</td>
            <td class="py-2 px-3 border text-right font-semibold">
              {{ returnData.total_refund_amount | number: '1.0-2' }}
            </td>
          </tr>

          <tr *ngIf="returnData.returnItems?.length">
            <td colspan="6" class="bg-gray-50 border px-4 py-2">
              <div>
                <h4 class="font-medium text-gray-700 mb-2">
                  Returned Items:
                </h4>
                <ul class="pl-4 list-disc text-gray-600">
                  <li
                    *ngFor="let item of returnData.returnItems"
                    class="flex justify-between border-b py-1"
                  >
                    <span>
                      {{ item.product?.product_name }}
                      <span class="text-gray-500 text-sm">
                        (Qty: {{ item.quantity }})
                      </span>
                    </span>
                    <span class="text-right text-gray-800 font-medium">
                      Rs. {{ item.refund_amount | number: '1.0-2' }}
                    </span>
                  </li>
                </ul>
              </div>
            </td>
          </tr>
        </ng-container>

        <tr class="bg-gray-200 font-semibold text-gray-900">
          <td colspan="5" class="py-2 px-3 border text-right">Total Refunds:</td>
          <td class="py-2 px-3 border text-right">
            {{ totalRefundAmount | number: '1.0-2' }}
          </td>
        </tr>

        <tr class="bg-gray-100 font-semibold text-gray-800">
          <td colspan="5" class="py-2 px-3 border text-right">
            Total Items Returned:
          </td>
          <td class="py-2 px-3 border text-right">
            {{ totalReturnedItems }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
